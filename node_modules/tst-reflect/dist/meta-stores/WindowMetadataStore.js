"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.WindowMetadataStore = void 0;
const consts_1 = require("../consts");
const Type_1 = require("../Type");
const MetadataStoreBase_1 = require("./MetadataStoreBase");
class WindowMetadataStore extends MetadataStoreBase_1.MetadataStoreBase {
    constructor() {
        super(...arguments);
        this._store = {};
    }
    static initiate() {
        if (!window) {
            throw new Error("This environment does not support window store. Are you running this in a nodejs environment?");
        }
        if (window[consts_1.REFLECT_STORE_SYMBOL]) {
            return window[consts_1.REFLECT_STORE_SYMBOL];
        }
        window[consts_1.REFLECT_STORE_SYMBOL] = new WindowMetadataStore();
        Type_1.Type._setStore(window[consts_1.REFLECT_STORE_SYMBOL]);
        return window[consts_1.REFLECT_STORE_SYMBOL];
    }
    static get() {
        return window[consts_1.REFLECT_STORE_SYMBOL] || this.initiate();
    }
    get store() {
        return this._store;
    }
    get(id) {
        var _a;
        return (_a = this._store[id]) !== null && _a !== void 0 ? _a : undefined;
    }
    getLazy(id) {
        return function lazyType() {
            var _a;
            return (_a = window[consts_1.REFLECT_STORE_SYMBOL].get(id)) !== null && _a !== void 0 ? _a : undefined;
        };
    }
}
exports.WindowMetadataStore = WindowMetadataStore;
